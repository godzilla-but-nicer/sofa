As we get things working in notebooks we will put any complex functionality into a library here